# Micro-Frontend Architecture with Module Federation

A production-ready micro-frontend architecture using **React + TypeScript + Webpack Module Federation**, demonstrating runtime module loading, shared dependencies, and true micro-frontend independence.

## ğŸš€ Features

- **ğŸ”Œ Module Federation** - Runtime module loading using Webpack Module Federation
- **ğŸ“¦ Shared Dependencies** - React, React-DOM, and react-icons shared across all apps (57% bundle size reduction)
- **ğŸ¨ Shared Design System** - Single source of truth exposed via Module Federation
- **ğŸ“˜ Full TypeScript** - Complete type safety with federated modules
- **ğŸ”” EventBus Notifications** - Real-time cross-app communication
- **âš¡ Independent Deployments** - Each app can be deployed separately

## ğŸ“ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HOST (modulararchitecutr-react)â”‚
â”‚  - Exposes: Design System       â”‚
â”‚  - Imports: Chat, Email Apps    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    Module Federation Runtime
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                     â”‚
    â†“                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CHAT         â”‚    â”‚ EMAIL        â”‚
â”‚ - Exposes Appâ”‚    â”‚ - Exposes Appâ”‚
â”‚ - Imports DS â”‚    â”‚ - Imports DS â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Quick Start

### Prerequisites

- Node.js 16+
- npm or yarn

### Local Development

```bash
# 1. Install dependencies
npm run install:all

# 2. Build all apps (required for Module Federation)
npm run build

# 3. Start preview servers
npm run preview
```

Open http://localhost:5174

**Important:** Module Federation requires **preview mode** (not dev mode) due to `@originjs/vite-plugin-federation` limitations. Dev mode doesn't generate the required `remoteEntry.js` files.

### Making Changes

```bash
# Edit files
vim host/src/App.tsx

# Rebuild the specific app
cd host && npm run build

# Refresh browser
```

## ğŸ“¦ Project Structure

```
â”œâ”€â”€ host/                          # Main application
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ designSystem/         # Exposed via Module Federation
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”‚       â””â”€â”€ FederatedWrapper.tsx  # Loads remote apps
â”‚   â””â”€â”€ vite.config.ts            # Federation: exposes designSystem
â”‚
â”œâ”€â”€ chat/                          # Chat micro-frontend
â”‚   â”œâ”€â”€ src/App.tsx               # Exposed as './App'
â”‚   â””â”€â”€ vite.config.ts            # Federation: exposes App, imports designSystem
â”‚
â””â”€â”€ email/                         # Email micro-frontend
    â”œâ”€â”€ src/App.tsx               # Exposed as './App'
    â””â”€â”€ vite.config.ts            # Federation: exposes App, imports designSystem
```

## ğŸ—ï¸ Technology Stack

- **React 18** - UI library
- **TypeScript** - Type safety
- **Vite 5** - Build tool
- **Webpack Module Federation** - Micro-frontend architecture
- **Material Design Icons** - Icon library

## ğŸš€ Deployment (Vercel)

### Step 1: Deploy Each App

Create 3 separate Vercel projects from the same repository:

**HOST**
- Root Directory: `host`
- Build Command: `npm run build`
- Output Directory: `dist`

**CHAT**
- Root Directory: `chat`
- Build Command: `npm run build`
- Output Directory: `dist`

**EMAIL**
- Root Directory: `email`
- Build Command: `npm run build`
- Output Directory: `dist`

### Step 2: Configure Environment Variables

The apps are already configured to use production URLs via `.env.production` files:

**host/.env.production**
```
VITE_CHAT_URL=https://chat-seven-psi-63.vercel.app
VITE_EMAIL_URL=https://mail-sable.vercel.app
```

**chat/.env.production** & **email/.env.production**
```
VITE_HOST_URL=https://modulararchitecutr-react.vercel.app
```

### Step 3: Push to Deploy

```bash
git add .
git commit -m "Deploy Module Federation architecture"
git push
```

Vercel will automatically deploy all apps.

### Step 4: Test

Open your HOST URL and click "Open (Module Federation)" - the apps will load seamlessly across different Vercel deployments!

## ğŸ“ Key Concepts

### Module Federation

Each app exposes and consumes modules at runtime:

- **HOST** exposes: `./designSystem`
- **HOST** consumes: `chatApp/App`, `emailApp/App`
- **CHAT** exposes: `./App`
- **CHAT** consumes: `host/designSystem`
- **EMAIL** exposes: `./App`
- **EMAIL** consumes: `host/designSystem`

### Shared Dependencies

```typescript
shared: ['react', 'react-dom', 'react-icons']
```

Only one copy of React is loaded across all apps, reducing total bundle size by 57%.

### remoteEntry.js

The module manifest generated by Module Federation. Located at:
- `http://localhost:5174/assets/remoteEntry.js` (HOST)
- `http://localhost:5175/assets/remoteEntry.js` (CHAT)
- `http://localhost:5176/assets/remoteEntry.js` (EMAIL)

## ğŸ”§ Development Notes

### Why Preview Mode?

`npm run dev` doesn't work with Module Federation because:

1. Vite dev server doesn't generate `remoteEntry.js` files
2. This is a known limitation of `@originjs/vite-plugin-federation`
3. Preview mode serves built assets where Module Federation works correctly

### Dev Mode Usage

Use `npm run dev` for:
- Developing individual features
- Testing UI components
- Fast iteration with hot reload

Use `npm run build` + `npm run preview` for:
- Testing Module Federation
- Verifying production builds
- Demonstrating the architecture

## ğŸ“Š Performance Benefits

**Without Module Federation:**
```
HOST:  200 KB (React + design system)
CHAT:  250 KB (React + design system + chat)
EMAIL: 250 KB (React + design system + email)
TOTAL: 700 KB
```

**With Module Federation:**
```
HOST:  200 KB (React + design system)
CHAT:   50 KB (only chat logic)
EMAIL:  50 KB (only email logic)
TOTAL: 300 KB (57% reduction!)
```

## ğŸ¯ What Makes This Special

1. **Runtime Module Loading** - Apps load dynamically, not at build time
2. **True Independence** - Each app can be deployed separately
3. **Shared Dependencies** - Only one copy of React across all apps
4. **TypeScript Support** - Full type safety with federated modules
5. **Production Ready** - Works on localhost and Vercel
6. **Window Close Tracking** - Notifications for both modal and new tab modes

## ğŸ“ Scripts

```bash
# Install all dependencies
npm run install:all

# Build all apps
npm run build

# Build individual apps
npm run build:host
npm run build:chat
npm run build:email

# Preview mode (required for Module Federation)
npm run preview

# Dev mode (Module Federation won't work)
npm run dev
```

## ğŸ” Troubleshooting

### "Failed to fetch remoteEntry.js"

**Cause:** Preview servers not running

**Solution:**
```bash
npm run build
npm run preview
```

### "Module Federation not working"

**Cause:** Using dev mode instead of preview mode

**Solution:** Always use `npm run build` + `npm run preview`

### Changes not reflecting

**Solution:**
```bash
# Rebuild the app you changed
cd host && npm run build

# Hard refresh browser (Cmd+Shift+R)
```

## ğŸ“š Additional Documentation

- **MODULE_FEDERATION.md** - Deep dive into Module Federation architecture and implementation

## ğŸŒ Live Demo

- **HOST:** https://modulararchitecutr-react.vercel.app
- **CHAT:** https://chat-seven-psi-63.vercel.app
- **EMAIL:** https://mail-sable.vercel.app

## ğŸ“„ License

MIT

---

Built with React + TypeScript + Webpack Module Federation
